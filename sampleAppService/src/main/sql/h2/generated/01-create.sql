--
-- (c) Copyright 2005-2013 JAXIO, http://www.jaxio.com
-- Source code generated by Celerio, a Jaxio product
-- Want to use Celerio within your company? email us at info@jaxio.com
-- Follow us on twitter: @springfuse
-- Template pack-backend-jpa:src/main/sql/h2/01-create.p.vm.sql
--
DROP ALL objects;

CREATE TABLE person (
	ID VARCHAR(32) not null
	,LOGIN VARCHAR(255) not null
	,PASSWORD VARCHAR(255) not null
	,EMAIL VARCHAR(255) not null
	,IS_ENABLED BIT
	,CIVILITY VARCHAR(5)
	,FIRST_NAME VARCHAR(255)
	,LAST_NAME VARCHAR(255)
	,BIRTH_DATE TIMESTAMP not null
	,VERSION INTEGER(10) default 0
	,PHOTO LONGVARBINARY(2147483647)
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY
	ON person (ID);
CREATE UNIQUE INDEX IF NOT EXISTS PERSON_UNIQUE_1_INDEX_8
	ON person (LOGIN);
CREATE UNIQUE INDEX IF NOT EXISTS PERSON_UNIQUE_2_INDEX_8
	ON person (EMAIL);
CREATE PRIMARY KEY 
	ON person (ID);

CREATE TABLE person_role (
	PERSON_ID VARCHAR(32) not null
	,ROLE_ID INTEGER(10) not null
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY
	ON person_role (PERSON_ID,ROLE_ID);
CREATE INDEX IF NOT EXISTS PERSON_ROLE_FK_1_INDEX_6
	ON person_role (PERSON_ID);
CREATE INDEX IF NOT EXISTS PERSON_ROLE_FK_2_INDEX_6
	ON person_role (ROLE_ID);
CREATE PRIMARY KEY 
	ON person_role (PERSON_ID,ROLE_ID);

CREATE TABLE role (
	ID INTEGER(10) not null
	,ROLE_NAME VARCHAR(255) not null
	,ROLE_DESC VARCHAR(255) not null
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY
	ON role (ID);
CREATE UNIQUE INDEX IF NOT EXISTS ROLE_UNIQUE_1_INDEX_2
	ON role (ROLE_NAME);
ALTER TABLE role ALTER COLUMN ID IDENTITY;


ALTER TABLE person_role 
	ADD CONSTRAINT PERSON_ROLE_FK_1
		FOREIGN KEY (PERSON_ID)
			REFERENCES person (ID);
ALTER TABLE person_role 
	ADD CONSTRAINT PERSON_ROLE_FK_2
		FOREIGN KEY (ROLE_ID)
			REFERENCES role (ID);
